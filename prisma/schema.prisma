generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL") // Supabase PostgreSQL URL
}

model User {
  id        String   @id // Clerk's userId (e.g., "user_2...")
  email     String   @unique
  createdAt DateTime // Controlled by Clerk's created_at
  updatedAt DateTime // Controlled by Clerk's updated_at
}

model Admin {
  id        String   @id // Clerk's userId (e.g., "user_2...")
  email     String   @unique
  createdAt DateTime // Controlled by Clerk's created_at
  updatedAt DateTime // Controlled by Clerk's updated_at
}

model Student {
  id        String        @id @default(uuid())
  name      String
  email     String        @unique
  phone     String
  dept      Dept
  session   Session
  createdAt DateTime      @default(now())
  attempts  QuizAttempt[]
}

model Quiz {
  id        String        @id @default(uuid())
  title     String
  duration  Int           @default(25) // Duration in minutes
  questions Question[]
  attempts  QuizAttempt[]
}

model Question {
  id            String @id @default(uuid())
  quizId        String
  text          String
  options       Json // Array of options stored as JSON
  correctAnswer String
  quiz          Quiz   @relation(fields: [quizId], references: [id])
}

model QuizAttempt {
  id          String    @id @default(uuid())
  studentId   String
  quizId      String
  score       Float
  startedAt   DateTime  @default(now())
  completedAt DateTime?
  student     Student   @relation(fields: [studentId], references: [id])
  quiz        Quiz      @relation(fields: [quizId], references: [id])
}

enum Dept {
  Bangla
  Economics
  Management
  Sociology
  Music
}

enum Session {
  Y2017_18
  Y2018_19
  Y2019_20
  Y2020_21
  Y2021_22
  Y2022_23
  Y2024_25
}
